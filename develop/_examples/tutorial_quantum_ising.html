

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Part 1: Reconstruction of a positive wavefunction &mdash; QuCumber develop documentation</title>
  

  
  
  
  
    <link rel="canonical" href="http://piquil.github.io/QuCumber/master/_examples/tutorial_quantum_ising.html"/>
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Part 2: Training an RBM with a phase" href="tutorial_qubits.html" />
    <link rel="prev" title="Download the tutorial" href="../tutorial.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> QuCumber
          

          
          </a>

          
            
            
              <div class="version">
                develop
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Introduction</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial.html">Download the tutorial</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Part 1: Reconstruction of a positive wavefunction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Getting-Started">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Training">Training</a></li>
<li class="toctree-l2"><a class="reference internal" href="#After-Training">After Training</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_qubits.html">Part 2: Training an RBM <em>with</em> a phase</a></li>
<li class="toctree-l1"><a class="reference internal" href="../theory.html">Theory</a></li>
</ul>
<p class="caption"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../rbm.html">RBM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quantum_states.html">Quantum States</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quantum_reconstruction.html">Quantum Reconstruction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../callbacks.html">Callbacks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../observables.html">Observables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cplx.html">Complex Algebra</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data.html">Data Handler</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">QuCumber</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Part 1: Reconstruction of a positive wavefunction</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/_examples/tutorial_quantum_ising.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #303F9F;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #D84315;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 8ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #cfcfcf;
    border-radius: 2px;
    background: #f7f7f7;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.pngmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}
</style>
<div class="section" id="Part-1:-Reconstruction-of-a-positive-wavefunction">
<h1>Part 1: Reconstruction of a positive wavefunction<a class="headerlink" href="#Part-1:-Reconstruction-of-a-positive-wavefunction" title="Permalink to this headline">¶</a></h1>
<div class="section" id="Getting-Started">
<h2>Getting Started<a class="headerlink" href="#Getting-Started" title="Permalink to this headline">¶</a></h2>
<p>The following imports are needed to run this tutorial:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">from</span> <span class="nn">qucumber.binary_rbm</span> <span class="k">import</span> <span class="n">BinaryRBM</span>
<span class="kn">from</span> <span class="nn">qucumber.quantum_reconstruction</span> <span class="k">import</span> <span class="n">QuantumReconstruction</span>
<span class="kn">from</span> <span class="nn">qucumber.positive_wavefunction</span> <span class="k">import</span> <span class="n">PositiveWavefunction</span>

<span class="kn">from</span> <span class="nn">qucumber.callbacks</span> <span class="k">import</span> <span class="n">MetricEvaluator</span>

<span class="kn">import</span> <span class="nn">qucumber.utils.training_statistics</span> <span class="k">as</span> <span class="nn">ts</span>
<span class="kn">import</span> <span class="nn">qucumber.utils.data</span> <span class="k">as</span> <span class="nn">data</span>

<span class="kn">import</span> <span class="nn">quantum_ising_chain</span>
<span class="kn">from</span> <span class="nn">quantum_ising_chain</span> <span class="k">import</span> <span class="n">TFIMChainEnergy</span><span class="p">,</span> <span class="n">TFIMChainMagnetization</span>
                                <span class="c1"># for calculating observables after training. More later...</span>
</pre></div>
</div>
</div>
<p><em>BinaryRBM</em> contains generic properties of an RBM with a binary visible
and hidden layer (e.g. functions for its effective energy and sampling
the hidden and visible layers).</p>
<p>The actual quantum wavefunction reconstruction occurs in the
<em>QuantumReconstruction</em>. A <em>QuantumReconstruction</em> object is initialized
with a neural network state (in this case, a <em>PositiveWavefunction</em>
object).</p>
<p><em>callbacks</em> contains functions that allow the user to evaluate the
quality of the training (i.e. based on the fidelity or KL divergence).
<em>training_statistics</em> contains the utilities in order to calculate
these training evaluators.</p>
<p><em>data</em> contains functions that handle loading the training data.</p>
<p><em>quantum_ising_chain</em> is not a part of QuCumber; it comprises of
classes and functions that will calculate the energy and magnetization
of a transverse-field Ising model (TFIM). <em>quantum_ising_chain</em>
inherits properties from the <em>Observables</em> class (part of QuCumber - see
observables.py). We encourage users to follow a similar structure to
<em>quantum_ising_chain</em> when calculating observables for other systems
(i.e. not a TFIM).</p>
</div>
<div class="section" id="Training">
<h2>Training<a class="headerlink" href="#Training" title="Permalink to this headline">¶</a></h2>
<p>Let’s beging with training the RBM on a positive wavefunction. We
consider the quantum Ising model with the Hamiltonian
<img class="math" src="../_images/math/1508bda9d0f65fd9a59943cdeb04b20de94a70a5.svg" alt="H=-J\sum_{\langle i j \rangle} S^z_i S^z_j - h \sum_i S^x_i"/> at
its quantum critical point <img class="math" src="../_images/math/938c78ddadc27b3f253378a1244a1b079fed702a.svg" alt="h/J=1"/>. The training data has been
generated and is contained in the file
<em>tfim1d_N10_train_samples.txt</em>. It contains 10,000 measurements of
the <img class="math" src="../_images/math/1a71c3e88c7ef8922cbc168d39ba6e634a6bd99e.svg" alt="S^z"/> states of 10 qubits, represented as zeros or ones.</p>
<p>To evaluate how well the RBM is training, we compute the fidelity,
<img class="math" src="../_images/math/496ef73beb17b6beb75c9a3cfe898fdea733f1cf.svg" alt="|\langle \psi|\psi_{\rm RBM} \rangle|^2"/>, between the true
wavefunction of the system and the wavefunction the RBM reconstructs.
First, we need to load our training data and the true wavefunction of
this system.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">train_samples_path</span> <span class="o">=</span> <span class="s1">&#39;tfim1d_train_samples.txt&#39;</span>
<span class="n">psi_path</span>           <span class="o">=</span> <span class="s1">&#39;tfim1d_psi.txt&#39;</span>

<span class="n">train_samples</span><span class="p">,</span><span class="n">target_psi</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">load_data</span><span class="p">(</span><span class="n">train_samples_path</span><span class="p">,</span><span class="n">psi_path</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The following arguments are required to construct a
<strong>PositiveWavefunction</strong> neural network state:</p>
<ol class="arabic simple">
<li><strong>The number of visible units</strong>. This is 10 for the case of our
dataset.</li>
<li><strong>The number of hidden units in the hidden layer of the RBM</strong>. This
number is set to the number of visible units by default (10 in the
case of our dataset).</li>
</ol>
<p>One may also choose to run this tutorial on a GPU by adding in “gpu =
True” as an argument to <strong>PositiveWavefunction</strong>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">nv</span> <span class="o">=</span> <span class="n">train_samples</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">nh</span> <span class="o">=</span> <span class="n">nv</span>

<span class="n">nn_state</span> <span class="o">=</span> <span class="n">PositiveWavefunction</span><span class="p">(</span><span class="n">num_visible</span><span class="o">=</span><span class="n">nv</span><span class="p">,</span><span class="n">num_hidden</span><span class="o">=</span><span class="n">nh</span><span class="p">,</span><span class="n">gpu</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Now we can specify the parameters of the training process:</p>
<ol class="arabic simple">
<li><strong>epochs</strong>: the number of epochs, i.e. training cycles that will be
performed.</li>
<li><strong>batch_size</strong>: the number of data points used in the positive phase
of the gradient.</li>
<li><strong>num_chains</strong>: the number of data points used in the negative phase
of the gradient. Keeping this larger than the <em>batch_size</em> is
preferred.</li>
<li><strong>CD</strong>: the number of contrastive divergence steps.</li>
<li><strong>lr</strong>: the learning rate.</li>
<li><strong>log_every</strong>: how often you would like the program to update you
during the training; say we choose 50 - that is, every 50 epochs the
program will print out the fidelity. This parameter is required in
the <em>MetricEvaluator</em>.</li>
</ol>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">epochs</span>     <span class="o">=</span> <span class="mi">1000</span>
<span class="n">batch_size</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">num_chains</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">CD</span>         <span class="o">=</span> <span class="mi">1</span>
<span class="n">lr</span>         <span class="o">=</span> <span class="mf">0.01</span>
<span class="n">log_every</span>  <span class="o">=</span> <span class="mi">50</span>
</pre></div>
</div>
</div>
<p>Once we initialize the parameters of the <strong>PositiveWavefunction</strong> and
the <strong>MetricEvaluator</strong>, we can begin training. Our
<strong>QuantumReconstruction</strong> object, <em>qr</em> (see below), contains a function
called <em>fit</em> that executes the training process.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">nn_state</span><span class="o">.</span><span class="n">space</span> <span class="o">=</span> <span class="n">nn_state</span><span class="o">.</span><span class="n">generate_hilbert_space</span><span class="p">(</span><span class="n">nv</span><span class="p">)</span> <span class="c1"># generate the entire visible space of the system.</span>
<span class="n">callbacks</span> <span class="o">=</span> <span class="p">[</span><span class="n">MetricEvaluator</span><span class="p">(</span><span class="n">log_every</span><span class="p">,{</span><span class="s1">&#39;Fidelity&#39;</span><span class="p">:</span><span class="n">ts</span><span class="o">.</span><span class="n">fidelity</span><span class="p">,</span><span class="s1">&#39;KL&#39;</span><span class="p">:</span><span class="n">ts</span><span class="o">.</span><span class="n">KL</span><span class="p">},</span><span class="n">target_psi</span><span class="o">=</span><span class="n">target_psi</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)]</span>

<span class="n">qr</span> <span class="o">=</span> <span class="n">QuantumReconstruction</span><span class="p">(</span><span class="n">nn_state</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">nn_state</span><span class="o">.</span><span class="n">initialize_parameters</span><span class="p">()</span> <span class="c1"># randomize the network parameters.</span>
<span class="n">qr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_samples</span><span class="p">,</span> <span class="n">epochs</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">,</span> <span class="n">num_chains</span><span class="p">,</span> <span class="n">CD</span><span class="p">,</span> <span class="n">lr</span><span class="p">,</span> <span class="n">progbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">callbacks</span><span class="o">=</span><span class="n">callbacks</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Epoch: 50       Fidelity = 0.805643     KL = 0.398929
Epoch: 100      Fidelity = 0.918037     KL = 0.161559
Epoch: 150      Fidelity = 0.945717     KL = 0.107650
Epoch: 200      Fidelity = 0.965527     KL = 0.069063
Epoch: 250      Fidelity = 0.976701     KL = 0.046738
Epoch: 300      Fidelity = 0.981118     KL = 0.037610
Epoch: 350      Fidelity = 0.983946     KL = 0.032158
Epoch: 400      Fidelity = 0.988306     KL = 0.023474
Epoch: 450      Fidelity = 0.989824     KL = 0.020578
Epoch: 500      Fidelity = 0.989882     KL = 0.020447
Epoch: 550      Fidelity = 0.991785     KL = 0.016671
Epoch: 600      Fidelity = 0.991949     KL = 0.016241
Epoch: 650      Fidelity = 0.992224     KL = 0.015684
Epoch: 700      Fidelity = 0.992276     KL = 0.015569
Epoch: 750      Fidelity = 0.993354     KL = 0.013352
Epoch: 800      Fidelity = 0.993704     KL = 0.012709
Epoch: 850      Fidelity = 0.992048     KL = 0.016135
Epoch: 900      Fidelity = 0.994572     KL = 0.010908
Epoch: 950      Fidelity = 0.993769     KL = 0.012580
Epoch: 1000     Fidelity = 0.994645     KL = 0.010701

Elapsed time = 108.96
</pre></div></div>
</div>
</div>
<div class="section" id="After-Training">
<h2>After Training<a class="headerlink" href="#After-Training" title="Permalink to this headline">¶</a></h2>
<p>After training the RBM, the <em>fit</em> function will have stored the trained
weights and biases. Now, we can generate samples from the trained RBM
and calculate physical observables.</p>
<p>We have created an example python file called <em>quantum_ising_chain.py</em>
that calculates the energy and magnetization of a TFIM.</p>
<p><em>quantum_ising_chain</em> comprises of two classes: one to calculate the
energy of a TFIM (<strong>TFIMChainEnergy</strong>) and one to calculate the
magnetization of a TFIM (<strong>TFIMChainMagnetization</strong>). The following
arguments are required to instatiate those objects.</p>
<ol class="arabic simple">
<li><strong>h</strong>: This is the <em>h/J</em> value of the TFIM (1 in the case of our
dataset). This is only needed in <strong>TFIMChainEnergy</strong>.</li>
<li><strong>n_samples</strong>: The number of samples to be generated from the
trained RBM. These samples will be used to calculate the observables.</li>
</ol>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">h</span>         <span class="o">=</span> <span class="mi">1</span>
<span class="n">n_samples</span> <span class="o">=</span> <span class="mi">5000</span>

<span class="n">tfim_energy</span> <span class="o">=</span> <span class="n">TFIMChainEnergy</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">n_samples</span><span class="p">)</span>
<span class="n">tfim_sZ</span>     <span class="o">=</span> <span class="n">TFIMChainMagnetization</span><span class="p">(</span><span class="n">n_samples</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>As stated previously, the <strong>TFIMChainEnergy</strong> and
<strong>TFIMChainMagnetization</strong> classes inherit properties from
<strong>Observables</strong>. To go ahead and calculate the energy and magnetization
along with their respective standard errors, we call the <em>statistics</em>
function in <strong>Observables</strong>, which requires the neural network state (in
this case, <strong>PositiveWavefunction</strong>) and the number of samples that are
to be generated.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">energy_stats</span> <span class="o">=</span> <span class="n">tfim_energy</span><span class="o">.</span><span class="n">statistics</span><span class="p">(</span><span class="n">nn_state</span><span class="p">,</span> <span class="n">n_samples</span><span class="p">)</span>
<span class="n">sZ_stats</span>     <span class="o">=</span> <span class="n">tfim_sZ</span><span class="o">.</span><span class="n">statistics</span><span class="p">(</span><span class="n">nn_state</span><span class="p">,</span> <span class="n">n_samples</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Mean energy: &#39;</span><span class="p">,</span><span class="n">energy_stats</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">],</span><span class="s1">&#39; +/- &#39;</span><span class="p">,</span><span class="n">energy_stats</span><span class="p">[</span><span class="s1">&#39;std_error&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Mean magnetization: &#39;</span><span class="p">,</span><span class="n">sZ_stats</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">],</span><span class="s1">&#39; +/- &#39;</span><span class="p">,</span><span class="n">sZ_stats</span><span class="p">[</span><span class="s1">&#39;std_error&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Mean energy:  -1.2346806605038514  +/-  0.0006359546056420108
Mean magnetization:  0.5481600000000002  +/-  0.004394995571922161
</pre></div></div>
</div>
<p>The exact value for the energy is -1.2381, and for the magnetization is
0.5610. To see the how quickly the energy and magnetization converge as
a function of the sampling step, <em>n_eq</em>, the code below will do the
trick.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">n_eq</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">dict_observables</span> <span class="o">=</span> <span class="n">quantum_ising_chain</span><span class="o">.</span><span class="n">Convergence</span><span class="p">(</span><span class="n">nn_state</span><span class="p">,</span> <span class="n">tfim_energy</span><span class="p">,</span> <span class="n">tfim_sZ</span><span class="p">,</span> <span class="n">n_samples</span><span class="p">,</span> <span class="n">n_eq</span><span class="p">)</span>

<span class="n">energy</span>     <span class="o">=</span> <span class="n">dict_observables</span><span class="p">[</span><span class="s1">&#39;energy&#39;</span><span class="p">][</span><span class="s1">&#39;energies&#39;</span><span class="p">]</span>
<span class="n">err_energy</span> <span class="o">=</span> <span class="n">dict_observables</span><span class="p">[</span><span class="s1">&#39;energy&#39;</span><span class="p">][</span><span class="s1">&#39;error&#39;</span><span class="p">]</span>

<span class="n">sZ</span>     <span class="o">=</span> <span class="n">dict_observables</span><span class="p">[</span><span class="s1">&#39;sigmaZ&#39;</span><span class="p">][</span><span class="s1">&#39;sZ&#39;</span><span class="p">]</span>
<span class="n">err_sZ</span> <span class="o">=</span> <span class="n">dict_observables</span><span class="p">[</span><span class="s1">&#39;sigmaZ&#39;</span><span class="p">][</span><span class="s1">&#39;error&#39;</span><span class="p">]</span>

<span class="n">step</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n_eq</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">step</span><span class="p">,</span> <span class="n">energy</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="o">-</span><span class="mf">1.2381</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">step</span><span class="p">,</span> <span class="n">energy</span><span class="o">-</span><span class="n">err_energy</span><span class="p">,</span> <span class="n">energy</span><span class="o">+</span><span class="n">err_energy</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n_eq</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.26</span><span class="p">,</span><span class="o">-</span><span class="mf">1.22</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;CD Step&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Energy&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">()</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">step</span><span class="p">,</span> <span class="n">sZ</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mf">0.5610</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">step</span><span class="p">,</span> <span class="n">sZ</span><span class="o">-</span><span class="n">err_sZ</span><span class="p">,</span> <span class="n">sZ</span><span class="o">+</span><span class="n">err_sZ</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n_eq</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;CD Step&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Magnetization&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[9]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>Text(0,0.5,&#39;Magnetization&#39;)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/_examples_tutorial_quantum_ising_16_1.png" src="../_images/_examples_tutorial_quantum_ising_16_1.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/_examples_tutorial_quantum_ising_16_2.png" src="../_images/_examples_tutorial_quantum_ising_16_2.png" />
</div>
</div>
<p>You can see a brief transient period in each observable, before the
state of the machine “warms up” to equilibrium. After that, the values
fluctuate around the mean.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="tutorial_qubits.html" class="btn btn-neutral float-right" title="Part 2: Training an RBM with a phase" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../tutorial.html" class="btn btn-neutral" title="Download the tutorial" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, PIQuIL.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  
    <h1>QuCumber Documentation</h1>
    <h2>Versions:</h2>
    <ul>
    
    </ul>


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'develop',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>